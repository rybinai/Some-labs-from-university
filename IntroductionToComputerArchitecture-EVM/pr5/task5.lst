GAS LISTING task5.S 			page 1


   1              	/*
   2              	         as -ahlsm=task5.lst --32 -gstabs+ -o task5.o task5.S
   3              	         ld -melf_i386 -o task5-exe-S task5.o
   4              	*/
   5              	
   6              	.include "my-macro"                     # Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ Ñ„Ð°Ð¹Ð»Ð° Ñ Ð¼Ð°ÐºÑ€Ð¾Ð¾Ð¿Ñ€ÐµÐ´
   1              	/* 
   2              	 * ÐœÐ°ÐºÑ€Ð¾Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ðµ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹.
   3              	 * ÐÑ€Ð³ÑƒÐ¼ÐµÐ½Ñ‚Ñ‹:
   4              	 *   - ÐºÐ¾Ð´ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ñ Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ñ‹
   5              	 *
   6              	 * ÐŸÐ¾ÑÐ»Ðµ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ Ð¼Ð°ÐºÑ€Ð¾Ð²Ñ‹Ð·Ð¾Ð²Ð° Ð¸Ð·Ð¼ÐµÐ½ÑÑŽÑ‚ÑÑ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ñ‹: %e
   7              	 * Ð¡Ð¼. Ñ‚Ð°ÐºÐ¶Ðµ 'man 2 exit'
   8              	*/
   9              	.macro Exit ret_val
  10              	  movl $1, %eax     # Ð½Ð¾Ð¼ÐµÑ€ ÑÐ¸ÑÑ‚. Ð²Ñ‹Ð·Ð¾Ð²Ð° exit
  11              	  movl \ret_val, %ebx   # ÐºÐ¾Ð´ Ð²Ñ‹Ñ…Ð¾Ð´Ð°
  12              	  int $0x80     # Ð²Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÑŒ ÑÐ¸ÑÑ‚ÐµÐ¼Ð½Ñ‹Ð¹ Ð²Ñ‹Ð·Ð¾Ð²
  13              	.endm
  14              	
  15              	
  16              	/*
  17              	 * ÐœÐ°Ñ€Ð¾Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ðµ Ð´Ð»Ñ Ð¿Ñ€Ð¾Ñ†ÐµÐ´ÑƒÑ€Ñ‹ ÑÑ‡Ð¸Ñ‚Ñ‹Ð²Ð°Ð½Ð¸Ñ Ð¾Ð´Ð½Ð¾Ð³Ð¾ ÑÐ¸Ð
  18              	 * ÐÑ€Ð³ÑƒÐ¼ÐµÐ½Ñ‚Ñ‹:
  19              	 *   - Ð°Ð´Ñ€ÐµÑ Ð±ÑƒÑ„Ñ„ÐµÑ€Ð° Ð´Ð»Ñ ÑÑ‡Ð¸Ñ‚Ñ‹Ð²Ð°Ð½Ð¸Ñ ÑÐ¸Ð¼Ð²Ð¾Ð»Ð°
  20              	 * Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚:
  21              	 *  - Ð² %eax ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ ÑÑ‡Ð¸Ñ‚Ð°Ð½Ð½Ñ‹Ñ… ÑÐ¸Ð¼Ð²Ð¾Ð»Ð¾Ð²
  22              	 *  - Ð¿Ð¾ Ð°Ð´Ñ€ÐµÑÑƒ buf_addr - ÑÑ‡Ð¸Ñ‚Ð°Ð½Ð½Ñ‹Ð¹ ÑÐ¸Ð¼Ð²Ð¾Ð»
  23              	 * 
  24              	 * ÐŸÐ¾ÑÐ»Ðµ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ Ð¼Ð°ÐºÑ€Ð¾Ð²Ñ‹Ð·Ð¾Ð²Ð° Ð¸Ð·Ð¼ÐµÐ½ÑÑŽÑ‚ÑÑ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ñ‹: %e
  25              	 * Ð¡Ð¼. Ñ‚Ð°ÐºÐ¶Ðµ 'man 2 read'
  26              	*/
  27              	.macro Getchar buf_addr
  28              	  movl $3, %eax    # Ð½Ð¾Ð¼ÐµÑ€ ÑÐ¸ÑÑ‚. Ð²Ñ‹Ð·Ð¾Ð²Ð° read
  29              	  movl $0, %ebx    # Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€ 1: Ð´ÐµÑÐºÑ€Ð¸Ð¿Ñ‚Ð¾Ñ€ ÑÑ‚Ð°Ð½Ð´Ð°Ñ€Ñ‚Ð½Ð¾Ð³Ð¾ Ð²Ð²Ð¾Ð´Ð°
  30              	  movl \buf_addr, %ecx  # Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€ 2: Ð°Ð´Ñ€ÐµÑ Ð±ÑƒÑ„ÐµÑ€Ð° (Ð¾Ð½ Ð¶Ðµ - Ñ„Ð°ÐºÑ‚Ð¸Ñ‡ÐµÑ
  31              	             # Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€ Ð¼Ð°ÐºÑ€Ð¾Ð²Ñ‹Ð·Ð¾Ð²Ð°)
  32              	  movl $1, %edx    # Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€ 3: ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð±Ð°Ð¹Ñ‚Ð¾Ð² Ð´Ð»Ñ Ñ‡Ñ‚ÐµÐ½Ð¸Ñ
  33              	  int $0x80    # Ð²Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÑŒ ÑÐ¸ÑÑ‚ÐµÐ¼Ð½Ñ‹Ð¹ Ð²Ñ‹Ð·Ð¾Ð²
  34              	.endm
  35              	
  36              	/*
  37              	 * ÐœÐ°Ñ€Ð¾Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ðµ Ð´Ð»Ñ Ð¿Ñ€Ð¾Ñ†ÐµÐ´ÑƒÑ€Ñ‹ Ð²Ñ‹Ð²Ð¾Ð´Ð° ÑÑ‚Ñ€Ð¾ÐºÐ¸ Ð² ÑÑ‚Ð°Ð½Ð´
  38              	 * ÐÑ€Ð³ÑƒÐ¼ÐµÐ½Ñ‚Ñ‹:
  39              	 *   - Ð¡Ñ‚Ñ€Ð¾ÐºÐ° Ð´Ð»Ñ Ð²Ñ‹Ð²Ð¾Ð´Ð°.
  40              	 *
  41              	 * ÐŸÑ€Ð¸Ð¼ÐµÑ‚Ñ€ Ð¼Ð°ÐºÑ€Ð¾Ð²Ñ‹Ð·Ð¾Ð²Ð°:
  42              	 *  Puts "Ð¢ÐµÐºÑÑ‚ Ð²Ñ‹Ð²Ð¾Ð´Ð¸Ð¼Ð¾Ð¹ ÑÑ‚Ñ€Ð¾ÐºÐ¸" 
  43              	 *
  44              	 * Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚:
  45              	 *  - Ð²Ñ‹Ð²Ð¾Ð´Ð¸Ñ‚ Ð² ÑÑ‚Ð°Ð½Ð´Ð°Ñ€Ñ‚Ð½Ñ‹Ð¹ Ð²Ñ‹Ð²Ð¾Ð´ ÑÐ¸Ð¼Ð²Ð¾Ð»Ñ‹ Ð·Ð°Ð´Ð°Ð½Ð½Ð¾Ð¹ ÑÑ‚Ñ€Ð¾Ð
  46              	 *    Ð° Ñ‚Ð°ÐºÐ¶Ðµ ÑÐ¸Ð¼Ð²Ð¾Ð» Ð¿ÐµÑ€ÐµÐ²Ð¾Ð´Ð° ÑÑ‚Ñ€Ð¾ÐºÐ¸
  47              	 *  
  48              	 * ÐŸÐ¾ÑÐ»Ðµ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ Ð¼Ð°ÐºÑ€Ð¾Ð²Ñ‹Ð·Ð¾Ð²Ð° Ð¸Ð·Ð¼ÐµÐ½ÑÑŽÑ‚ÑÑ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ñ‹: %e
  49              	 * Ð¡Ð¼. Ñ‚Ð°ÐºÐ¶Ðµ 'man puts', 'man 2 write'
  50              	*/
  51              	.macro Puts string
GAS LISTING task5.S 			page 2


  52              	.data
  53              	    str\@:   .ascii "\string\n"  # Ñ„Ð¾Ñ€Ð¼Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ñ„Ð°ÐºÑ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ð¹ ÑÑ‚Ñ€Ð¾ÐºÐ¸ Ð´Ð
  54              	  
  55              	    strlen\@ =   . - str\@           # Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ Ð´Ð»Ð¸Ð½Ñ‹ ÑÑ‚Ñ€Ð¾ÐºÐ¸
  56              	
  57              	.text
  58              	  movl $4, %eax    # Ð½Ð¾Ð¼ÐµÑ€ ÑÐ¸ÑÑ‚. Ð²Ñ‹Ð·Ð¾Ð²Ð° write
  59              	  movl $1, %ebx    # Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€ 1: Ð´ÐµÑÐºÑ€Ð¸Ð¿Ñ‚Ð¾Ñ€ ÑÑ‚Ð°Ð½Ð´Ð°Ñ€Ñ‚Ð½Ð¾Ð³Ð¾ Ð²Ñ‹Ð²Ð¾Ð´Ð°
  60              	  movl $str\@, %ecx  # Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€ 2: Ð°Ð´Ñ€ÐµÑ Ð¿Ð°Ð¼ÑÑ‚Ð¸ Ñ Ð²Ñ‹Ð²Ð¾Ð´Ð¸Ð¼Ñ‹Ð¼Ð¸ ÑÐ¸Ð¼Ð²
  61              	  movl $strlen\@, %edx   # Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€ 3: ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð±Ð°Ð¹Ñ‚Ð¾Ð² Ð´Ð»Ñ Ð²Ñ‹Ð²Ð¾Ð´Ð
  62              	  int $0x80    # Ð²Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÑŒ ÑÐ¸ÑÑ‚ÐµÐ¼Ð½Ñ‹Ð¹ Ð²Ñ‹Ð·Ð¾Ð²
  63              	.endm
   7              	
   8              	.bss
   9              	        .lcomm buf_vector 10            # Ð´Ð»Ñ Ð¾Ð´Ð½Ð¾Ð¹ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ð²ÑˆÐµÐ¹Ñ
  10              	        .lcomm c,1                      # Ð±ÑƒÑ„ÐµÑ€ Ð´Ð»Ñ Ñ‡Ñ‚ÐµÐ½Ð¸Ñ Ñ‚ÐµÐºÑƒÑ‰ÐµÐ³Ð¾ ÑÐ¸Ð¼Ð²Ð
  11              	
  12              	.data                                   # ÑÐµÐºÑ†Ð¸Ñ Ð´Ð°Ð½Ð½Ñ‹Ñ…, Ñ€Ð°ÑÐ¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ðµ Ð¿Ð
  13              	
  14 0000 0A000000 	ten:  .long 10
  15 0004 00000000 	l:      .long 0                         
  16 0008 00000000 	k:      .long 0
  17 000c 00000000 	f:      .long 0                         # ÐŸÐ¾Ð¸ÑÐº ÑÑ‚Ñ€Ð¾Ðº
  18 0010 00000000 	i:      .long 0                         # ÐŸÐ¾Ð¸ÑÐº Ð²Ð½ÑƒÑ‚Ñ€Ð¸ ÑÑ‚Ñ€Ð¾ÐºÐ¸ 
  19 0014 00000000 	sum:  .long 0                           
  20              	Matrix:                                 # ÐœÐ°Ñ‚Ñ€Ð¸Ñ†Ð°, ÑÑ‚Ð¾Ð»Ð±Ñ†Ñ‹ Ð¸ ÑÑ‚Ñ€Ð¾ÐºÐ¸ ÐºÐ¾Ñ‚Ð¾Ñ€
  21 0018 01000000 	        .long  1, 2,  3,  4,  5,  6 
  21      02000000 
  21      03000000 
  21      04000000 
  21      05000000 
  22 0030 07000000 	        .long  7, 8,  9,  10, 11, 12
  22      08000000 
  22      09000000 
  22      0A000000 
  22      0B000000 
  23 0048 0D000000 	        .long 13, 14, 15, 16, 17, 18
  23      0E000000 
  23      0F000000 
  23      10000000 
  23      11000000 
  24 0060 13000000 	        .long 19, 20, 21, 22, 23, 24 
  24      14000000 
  24      15000000 
  24      16000000 
  24      17000000 
  25 0078 19000000 	        .long 25, 26, 27, 28, 29, 30
  25      1A000000 
  25      1B000000 
  25      1C000000 
  25      1D000000 
  26 0090 1F000000 	        .long 31, 32, 33, 34, 35, 36
  26      20000000 
  26      21000000 
  26      22000000 
  26      23000000 
  27 00a8 00000000 	vector:  .long 0, 0, 0, 0, 0, 0         # Ð²ÐµÐºÑ‚Ð¾Ñ€ Ð¿Ð¾Ð»ÑƒÑ‡Ð°ÐµÐ¼Ñ‹Ð¹ Ð¿Ð¾ ÑƒÑÐ»Ð¾Ð²Ð¸ÑŽ Ð·Ð
GAS LISTING task5.S 			page 3


  27      00000000 
  27      00000000 
  27      00000000 
  27      00000000 
  28              	
  29              	.text                                   # ÑÐµÐºÑ†Ð¸Ñ ÐºÐ¾Ð¼Ð°Ð½Ð´ Ð¿Ñ€Ð¾Ñ†ÐµÑÐ¾Ñ€Ð°
  30              	
  31              	.global _start                          # Ñ‚Ð¾Ñ‡ÐºÐ° Ð²Ñ…Ð¾Ð´Ð° - Ð³Ð»Ð¾Ð±Ð°Ð»ÑŒÐ½Ð°Ñ Ð¼ÐµÑ‚ÐºÐ°
  32              	
  33              	_start:
  34              	        Puts "Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ñ†Ð¸Ñ„Ñ€Ñƒ Ð¾Ñ‚ 1 Ð´Ð¾ 6 :"                # Ð’Ð²Ð¾Ð´ Ð½Ð¾Ð¼ÐµÑ€Ð° ÑÑ
  34              	> .data
  34 00c0 D092D0B2 	>  str0:.ascii "Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ñ†Ð¸Ñ„Ñ€Ñƒ Ð¾Ñ‚ 1 Ð´Ð¾ 6 :\n"
  34      D0B5D0B4 
  34      D0B8D182 
  34      D0B520D1 
  34      86D0B8D1 
  34              	>  
  34              	>  strlen0 =. - str0
  34              	> 
  34              	> .text
  34 0000 B8040000 	>  movl $4,%eax
  34      00
  34 0005 BB010000 	>  movl $1,%ebx
  34      00
  34 000a B9C00000 	>  movl $str0,%ecx
  34      00
  34 000f BA2A0000 	>  movl $strlen0,%edx
  34      00
  34 0014 CD80     	>  int $0x80
  35              	
  36              	kdb_input_k:
  37              	        Getchar $c                      # ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÐ¼ Ñ ÐºÐ¾Ð¼Ð°Ð½Ð´Ð½Ð¾Ð¹ ÑÑ‚Ñ€Ð¾ÐºÐ¸ Ð·Ð½Ð
  37 0016 B8030000 	>  movl $3,%eax
  37      00
  37 001b BB000000 	>  movl $0,%ebx
  37      00
  37 0020 B90A0000 	>  movl $c,%ecx
  37      00
  37              	>  
  37 0025 BA010000 	>  movl $1,%edx
  37      00
  37 002a CD80     	>  int $0x80
  38 002c 83F800   	        cmpl $0, %eax                   # ÐšÐ¾Ð½ÐµÑ† Ñ„Ð°Ð¹Ð» - EOF (Ð²Ð²ÐµÐ´ÐµÐ½Ð¾ 0 ÑÐ¸Ð¼Ð²Ð¾Ð»Ð
  39 002f 0F84F901 	        je end                          # Ð”Ð° - Ð½Ð° Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ðµ Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ñ‹
  39      0000
  40 0035 803D0A00 	        cmpb $'\n', c                   # Ð­Ñ‚Ð¾ ÑÐ¸Ð¼Ð²Ð¾Ð» Ð¿ÐµÑ€ÐµÐ²Ð¾Ð´Ð° ÑÑ‚Ñ€Ð¾ÐºÐ¸ ?
  40      00000A
  41 003c 7429     	        je changer
  42 003e 803D0A00 	        cmpb $'6', c                    # ÐšÐ¾Ð´ Ð±Ð¾Ð»ÑŒÑˆÐµ ÐºÐ¾Ð´Ð° ÑÐ¸Ð¼Ð²Ð¾Ð»Ð° '6' ?
  42      000036
  43 0045 0F877501 	        ja print_err_msg1               # Ð”Ð - Ð½Ð° Ð²Ñ‹Ð²Ð¾Ð´ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ð¾Ð± Ð¾ÑˆÐ¸Ð±Ðº
  43      0000
  44 004b 803D0A00 	        cmpb $'1', c                    # ÐšÐ¾Ð´ Ð¼ÐµÐ½ÑŒÑˆÐµ ÐºÐ¾Ð´Ð° ÑÐ¸Ð¼Ð²Ð¾Ð»Ð° '1' ?
  44      000031
  45 0052 0F826801 	        jb print_err_msg1               # Ð”Ð - Ð½Ð° Ð²Ñ‹Ð²Ð¾Ð´ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ð¾Ð± Ð¾ÑˆÐ¸Ð±Ðº
  45      0000
GAS LISTING task5.S 			page 4


  46 0058 A00A0000 	        movb c, %al                     # ÐšÐ¾Ð´ Ð¸Ð· Ñ Ð¿Ð¸ÑˆÐµÐ¼ Ð² al
  46      00
  47 005d 83E830   	        subl $'0',%eax                  # ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÐ¼ Ñ‡Ð¸ÑÐ»Ð¾
  48 0060 A2080000 	        movb %al, k                     # Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ð¼Ð¾Ðµ al (Ð²Ð²ÐµÐ´ÐµÐ½Ð
  48      00
  49 0065 EBAF     	        jmp kdb_input_k
  50              	
  51              	changer:        
  52 0067 833D0800 	        cmpl $0, k                      # Ð‘Ñ‹Ð»Ð¾ Ð»Ð¸ Ð²Ð²ÐµÐ´ÐµÐ½Ð¾ Ð½Ð°Ñ‡Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð·Ð½Ð°Ñ‡Ð
  52      000000
  53 006e 0F848201 	        je error_inpit_k                # ÐÐµÑ‚ - Ð¶Ð´Ð¸ Ñ‡Ð¸ÑÐ»Ð° Ð² Ð±ÑƒÑ„ÐµÑ€Ðµ
  53      0000
  54 0074 A1080000 	        movl k, %eax                    # ÐšÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ð° k Ð² #eax
  54      00
  55 0079 83E801   	        subl $1, %eax                   # ÐŸÐµÑ€ÐµÐ¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÑÐµÐ¼ Ñ‚Ð¾Ñ‡Ð½Ñ‹Ð¹ Ð°Ð´Ñ€ÐµÑ Ð½Ñƒ
  56 007c A3080000 	        movl %eax, k                    # ÐšÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ ÑÐ»ÐµÐ¼ÐµÑ‚Ð½Ð° %eax Ð² k
  56      00
  57              	        Puts "Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ñ†Ð¸Ñ„Ñ€Ñƒ Ð¾Ñ‚ 1 Ð´Ð¾ 6 :"                # Ð’Ð²Ð¾Ð´ Ð½Ð¾Ð¼ÐµÑ€Ð° ÑÑ
  57              	> .data
  57 00ea D092D0B2 	>  str2:.ascii "Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ñ†Ð¸Ñ„Ñ€Ñƒ Ð¾Ñ‚ 1 Ð´Ð¾ 6 :\n"
  57      D0B5D0B4 
  57      D0B8D182 
  57      D0B520D1 
  57      86D0B8D1 
  57              	>  
  57              	>  strlen2 =. - str2
  57              	> 
  57              	> .text
  57 0081 B8040000 	>  movl $4,%eax
  57      00
  57 0086 BB010000 	>  movl $1,%ebx
  57      00
  57 008b B9EA0000 	>  movl $str2,%ecx
  57      00
  57 0090 BA2A0000 	>  movl $strlen2,%edx
  57      00
  57 0095 CD80     	>  int $0x80
  58              	
  59              	kdb_input_l:
  60              	        Getchar $c
  60 0097 B8030000 	>  movl $3,%eax
  60      00
  60 009c BB000000 	>  movl $0,%ebx
  60      00
  60 00a1 B90A0000 	>  movl $c,%ecx
  60      00
  60              	>  
  60 00a6 BA010000 	>  movl $1,%edx
  60      00
  60 00ab CD80     	>  int $0x80
  61 00ad 83F800   	        cmpl $0, %eax                   # ÐšÐ¾Ð½ÐµÑ† Ñ„Ð°Ð¹Ð» - EOF (Ð²Ð²ÐµÐ´ÐµÐ½Ð¾ 0 ÑÐ¸Ð¼Ð²Ð¾Ð»Ð
  62 00b0 0F847801 	        je end                          # Ð”Ð° - Ð½Ð° Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ðµ Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ñ‹
  62      0000
  63 00b6 803D0A00 	        cmpb $'\n', c                   # Ð­Ñ‚Ð¾ ÑÐ¸Ð¼Ð²Ð¾Ð» Ð¿ÐµÑ€ÐµÐ²Ð¾Ð´Ð° ÑÑ‚Ñ€Ð¾ÐºÐ¸ ?
  63      00000A
  64 00bd 742A     	        je next                         # ÐÐµÑ‚- Ð²Ð²Ð¾Ð´Ð¸Ð¼ ÑÐ»ÐµÐ´ÑƒÑŽÑˆÐ¸Ð¹ ÑÐ¸Ð¼Ð²Ð¾Ð»
  65 00bf 803D0A00 	        cmpb $'6', c                    # ÐšÐ¾Ð´ Ð±Ð¾Ð»ÑŒÑˆÐµ ÐºÐ¾Ð´Ð° ÑÐ¸Ð¼Ð²Ð¾Ð»Ð° '6' ?
GAS LISTING task5.S 			page 5


  65      000036
  66 00c6 0F870F01 	        ja print_err_msg                # Ð”Ð - Ð½Ð° Ð²Ñ‹Ð²Ð¾Ð´ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ð¾Ð± Ð¾ÑˆÐ¸Ð±Ðº
  66      0000
  67 00cc 803D0A00 	        cmpb $'1', c                    # ÐšÐ¾Ð´ Ð¼ÐµÐ½ÑŒÑˆÐµ ÐºÐ¾Ð´Ð° ÑÐ¸Ð¼Ð²Ð¾Ð»Ð° '1' ?
  67      000031
  68 00d3 0F820201 	        jb print_err_msg                # Ð”Ð - Ð½Ð° Ð²Ñ‹Ð²Ð¾Ð´ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ð¾Ð± Ð¾ÑˆÐ¸Ð±Ðº
  68      0000
  69 00d9 29C0     	        subl %eax, %eax                 # ÐžÐ±Ð½ÑƒÐ»ÑÐµÐ¼ eax
  70 00db A00A0000 	        movb c, %al                     # ÐšÐ¾Ð´ Ð¸Ð· Ñ Ð¿Ð¸ÑˆÐµÐ¼ Ð² al
  70      00
  71 00e0 2C30     	        subb $'0',%al                   # ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÐ¼ Ñ‡Ð¸ÑÐ»Ð¾Ð²Ð¾Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ ÑÐ¸Ð¼
  72 00e2 A2040000 	        movb %al, l                     # Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ð¼Ð¾Ðµ al (Ð²Ð²ÐµÐ´ÐµÐ½Ð
  72      00
  73 00e7 EBAE     	        jmp kdb_input_l
  74              	
  75              	next:
  76 00e9 833D0400 	        cmpl $0, l                      # Ð‘Ñ‹Ð»Ð¾ Ð»Ð¸ Ð²Ð²ÐµÐ´ÐµÐ½Ð¾ Ð½Ð°Ñ‡Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð·Ð½Ð°Ñ‡Ð
  76      000000
  77 00f0 0F841B01 	        je error_inpit_l                # ÐÐµÑ‚ - Ð²Ñ‹Ð²Ð¾Ð´ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ð¾Ð± Ð¾ÑˆÐ¸Ð±ÐºÐµ
  77      0000
  78 00f6 29C0     	        subl %eax,%eax                  # ÐžÐ±Ð½ÑƒÐ»ÑÐµÐ¼ eax
  79 00f8 A1040000 	        movl l, %eax                    
  79      00
  80 00fd 83E801   	        subl $1, %eax                   # ÐŸÐµÑ€ÐµÐ¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÑÐµÐ¼ Ñ‚Ð¾Ñ‡Ð½Ñ‹Ð¹ Ð°Ð´Ñ€ÐµÑ ÑÑ‚
  81 0100 A3040000 	        movl %eax, l
  81      00
  82 0105 29F6     	        subl %esi,%esi                  # Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð½Ð°Ñ‡Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ 
  83              	
  84              	pod_k:
  85 0107 29DB     	        subl %ebx, %ebx                 # j = 0
  86 0109 A0080000 	        movb k, %al                     # ÐÐ°Ñ…Ð¾Ð´Ð¸Ð¼ Ð½Ð¾Ð¼ÐµÑ€ Ð½ÑƒÐ¶Ð½Ð¾Ð¹ ÑÑ‚Ñ€Ð¾ÐºÐ¸
  86      00
  87 010e B118     	        movb $24, %cl                   # Ð£Ð¼Ð½Ð¾Ð¶Ð°ÐµÐ¼ Ð½Ð° ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð±Ð°Ð¹Ñ‚ Ð² Ñ
  88 0110 F6E9     	        imul %cl                        # Ð£Ð¼Ð½Ð¾Ð¶Ð°ÐµÐ¼ al*cl
  89 0112 BA180000 	        mov $Matrix, %edx               # ÐŸÐµÑ€ÐµÐ½Ð¾ÑÐ¸Ð¼ Ð°Ð´Ñ€ÐµÑ Ð¼Ð°ÑÑÐ¸Ð²Ð° Ð² %edx
  89      00
  90 0117 6601C2   	        addw %ax, %dx                   # ÐÐ°Ñ…Ð¾Ð´Ð¸Ð¼ Ð½ÑƒÐ¶Ð½ÑƒÑŽ ÑÑ‚Ñ€Ð¾ÐºÑƒ, Ð¿Ñ€Ð¸Ð±Ð°Ð²Ð»Ñ
  91 011a 01F3     	        addl %esi, %ebx                 # ÐŸÐµÑ€ÐµÐ½Ð¾ÑÐ¸Ð¼ Ð² %ebx, Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ i
  92              	
  93 011c 8B049A   	        movl (%edx,%ebx,4), %eax        # Matrix(k,i) = edx + ebx * 4
  94 011f A3140000 	        movl %eax, sum                  # ÐŸÐµÑ€ÐµÐ½Ð¾ÑÐ¸Ð¼
  94      00
  95              	
  96              	pod_l:
  97 0124 89350C00 	        movl %esi, f                    # ÐÐ°Ñ…Ð¾Ð´Ð¸Ð¼ Ð½ÑƒÐ¶Ð½ÑƒÑŽ ÑÑ‚Ñ€Ð¾Ñ‡ÐºÑƒ Ð´Ð»Ñ ÑÐ»ÐµÐ
  97      0000
  98 012a A00C0000 	        movb f, %al
  98      00
  99 012f B118     	        movb $24, %cl                   # ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð±Ð°Ð¹Ñ‚ Ð² ÑÑ‚Ñ€Ð¾ÐºÐµ
 100 0131 F6E9     	        imul %cl                        # Ð£Ð¼Ð½Ð¾Ð¶Ð°ÐµÐ¼ al*ah
 101 0133 29D2     	        subl %edx, %edx
 102 0135 BA180000 	        mov $Matrix, %edx
 102      00
 103 013a 6601C2   	        addw %ax, %dx                   # ÐÐ°Ñ…Ð¾Ð´Ð¸Ð¼ Ð½ÑƒÐ¶Ð½ÑƒÑŽ ÑÑ‚Ñ€Ð¾Ñ‡ÐºÑƒ
 104 013d 29DB     	        subl %ebx, %ebx                 # ÐžÐ¿Ñ€ÐµÐ´ÐµÐ»ÑÐµÐ¼ Ð½ÑƒÐ¶Ð½Ñ‹Ð¹ ÑÑ‚Ð¾Ð»Ð±ÐµÑ†
 105 013f 031D0400 	        addl l, %ebx
 105      0000
GAS LISTING task5.S 			page 6


 106              	
 107 0145 8B049A   	        movl (%edx,%ebx,4), %eax        # Matrix(i,l) = edx + ebx * 4
 108 0148 01051400 	        addl  %eax, sum                 # Matrix(i,l) + b(i)
 108      0000
 109 014e A1140000 	        movl sum, %eax
 109      00
 110 0153 89351000 	        movl  %esi, i                   # Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ð»Ð¸ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ
 110      0000
 111 0159 8904B5A8 	        movl %eax, vector(,%esi,4)      # ÐŸÐµÑ€ÐµÐ´Ð°ÐµÑ‚ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Ð¸Ð· %eax Ð¿Ð¾ Ð°Ð´Ñ€Ðµ
 111      000000
 112 0160 BE090000 	        movl $9, %esi 
 112      00
 113              	
 114              	del1:
 115 0165 BA000000 	        movl  $0, %edx                  # Ð“Ð¾Ñ‚Ð¾Ð²Ð¸Ð¼ Ð´ÐµÐ»ÐµÐ½Ð¸Ðµ
 115      00
 116 016a F73D0000 	        idivl ten                       # Ð”ÐµÐ»Ð¸Ð¼ Ð¾Ð±ÑŠÐµÐ´Ð¸Ð½ÐµÐ½Ð½Ñ‹Ðµ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ñ‹ edx:
 116      0000
 117 0170 89D3     	        movl %edx, %ebx                 # ÐŸÐµÑ€ÐµÐ½Ð¾ÑÐ¸Ð¼ Ð¾ÑÑ‚Ð°Ñ‚Ð¾Ðº Ð¾Ñ‚ Ð´ÐµÐ»ÐµÐ½Ð¸Ñ Ð² 
 118 0172 83C330   	        addl $48, %ebx                  # ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÐ¼ Ð¸Ð· Ñ†Ð¸Ñ„Ñ€Ñ‹ ÐºÐ¾Ð´ ascii
 119 0175 889E0000 	        movb %bl, buf_vector(%esi)      # ÐŸÐ¾Ð¼ÐµÑ‰Ð°ÐµÐ¼ Ñ‡Ð¸ÑÐ»Ð¾ Ð² Ð±ÑƒÑ„ÐµÑ€ Ð½Ð° Ð¼ÐµÑÑ‚Ð¾
 119      0000
 120 017b 4E       	        decl  %esi                      # Ð£Ð¼ÐµÐ½ÑŒÑˆÐ°ÐµÐ¼ Ð½Ð¾Ð¼ÐµÑ€ Ñ€Ð°Ð·Ñ€ÑÐ´Ð°
 121 017c 83F800   	        cmpl $0, %eax                   # Ð¡Ñ€Ð°Ð²Ð½Ð¸Ð²Ð°/ÐµÐ¼ Ñ‡Ð°ÑÑ‚Ð½Ð¾Ðµ Ñ Ð½ÑƒÐ»ÐµÐ¼
 122 017f 77E4     	        ja del1                         # ÐÐ•Ð¢ - Ð¿Ñ€Ð¾Ð´Ð¾Ð»Ð¶Ð°ÐµÐ¼ Ð´ÐµÐ»ÐµÐ½Ð¸Ðµ
 123              	
 124 0181 B8040000 	        movl $4, %eax                   
 124      00
 125 0186 BB010000 	        movl $1, %ebx
 125      00
 126 018b B9000000 	        movl $buf_vector, %ecx          
 126      00
 127 0190 BA0A0000 	        movl $10, %edx                  # Ð”Ð»Ð¸Ð½Ð° ÑÑ‚Ñ€Ð¾ÐºÐ¸
 127      00
 128 0195 CD80     	        int $0x80                       # ÐŸÑ€ÐµÑ€Ñ‹Ð²Ð°Ð½Ð¸Ðµ 0x80
 129              	        Puts " "
 129              	> .data
 129 0114 200A     	>  str4:.ascii " \n"
 129              	>  
 129              	>  strlen4 =. - str4
 129              	> 
 129              	> .text
 129 0197 B8040000 	>  movl $4,%eax
 129      00
 129 019c BB010000 	>  movl $1,%ebx
 129      00
 129 01a1 B9140100 	>  movl $str4,%ecx
 129      00
 129 01a6 BA020000 	>  movl $strlen4,%edx
 129      00
 129 01ab CD80     	>  int $0x80
 130              	                                        # ÐŸÑ€Ð¾Ð´Ð¾Ð»Ð¶Ð°ÐµÐ¼ Ð½Ð°Ñ…Ð¾Ð´Ð¸Ñ‚ÑŒ ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ñ‹ Ð²
 131 01ad 29F6     	        subl %esi, %esi
 132 01af 8B351000 	        movl i, %esi                    # Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‚ Ð¾Ð±Ñ€Ð°Ñ‚Ð½Ð¾
 132      0000
 133              	
 134 01b5 46       	        incl %esi
GAS LISTING task5.S 			page 7


 135 01b6 83FE06   	        cmpl $6, %esi
 136 01b9 7473     	        je end
 137 01bb E947FFFF 	        jmp pod_k
 137      FF
 138              	
 139              	print_err_msg1:
 140              	        Puts "ÐÐµÐ¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ñ‹Ð¹ Ð²Ð²Ð¾Ð´"
 140              	> .data
 140 0116 D09DD0B5 	>  str5:.ascii "ÐÐµÐ¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ñ‹Ð¹ Ð²Ð²Ð¾Ð´\n"
 140      D0BFD180 
 140      D0B0D0B2 
 140      D0B8D0BB 
 140      D18CD0BD 
 140              	>  
 140              	>  strlen5 =. - str5
 140              	> 
 140              	> .text
 140 01c0 B8040000 	>  movl $4,%eax
 140      00
 140 01c5 BB010000 	>  movl $1,%ebx
 140      00
 140 01ca B9160100 	>  movl $str5,%ecx
 140      00
 140 01cf BA220000 	>  movl $strlen5,%edx
 140      00
 140 01d4 CD80     	>  int $0x80
 141 01d6 E93BFEFF 	        jmp kdb_input_k
 141      FF
 142              	
 143              	print_err_msg:
 144              	        Puts "ÐÐµÐ¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ñ‹Ð¹ Ð²Ð²Ð¾Ð´"
 144              	> .data
 144 0138 D09DD0B5 	>  str6:.ascii "ÐÐµÐ¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ñ‹Ð¹ Ð²Ð²Ð¾Ð´\n"
 144      D0BFD180 
 144      D0B0D0B2 
 144      D0B8D0BB 
 144      D18CD0BD 
 144              	>  
 144              	>  strlen6 =. - str6
 144              	> 
 144              	> .text
 144 01db B8040000 	>  movl $4,%eax
 144      00
 144 01e0 BB010000 	>  movl $1,%ebx
 144      00
 144 01e5 B9380100 	>  movl $str6,%ecx
 144      00
 144 01ea BA220000 	>  movl $strlen6,%edx
 144      00
 144 01ef CD80     	>  int $0x80
 145 01f1 E971FEFF 	        jmp changer
 145      FF
 146              	
 147              	error_inpit_k:
 148              	        Puts "Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ k"
 148              	> .data
 148 015a D092D0B2 	>  str7:.ascii "Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ k\n"
GAS LISTING task5.S 			page 8


 148      D0B5D0B4 
 148      D0B8D182 
 148      D0B5206B 
 148      0A
 148              	>  
 148              	>  strlen7 =. - str7
 148              	> 
 148              	> .text
 148 01f6 B8040000 	>  movl $4,%eax
 148      00
 148 01fb BB010000 	>  movl $1,%ebx
 148      00
 148 0200 B95A0100 	>  movl $str7,%ecx
 148      00
 148 0205 BA110000 	>  movl $strlen7,%edx
 148      00
 148 020a CD80     	>  int $0x80
 149 020c E9EFFDFF 	        jmp _start
 149      FF
 150              	
 151              	error_inpit_l:
 152              	        Puts "Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ l"
 152              	> .data
 152 016b D092D0B2 	>  str8:.ascii "Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ l\n"
 152      D0B5D0B4 
 152      D0B8D182 
 152      D0B5206C 
 152      0A
 152              	>  
 152              	>  strlen8 =. - str8
 152              	> 
 152              	> .text
 152 0211 B8040000 	>  movl $4,%eax
 152      00
 152 0216 BB010000 	>  movl $1,%ebx
 152      00
 152 021b B96B0100 	>  movl $str8,%ecx
 152      00
 152 0220 BA110000 	>  movl $strlen8,%edx
 152      00
 152 0225 CD80     	>  int $0x80
 153 0227 E96BFEFF 	        jmp kdb_input_l
 153      FF
 154              	
 155              	text:
 156 022c EB00     	        jmp end
 157              	
 158              	end:
 159              	
 160              	Exit $0
 160 022e B8010000 	>  movl $1,%eax
 160      00
 160 0233 BB000000 	>  movl $0,%ebx
 160      00
 160 0238 CD80     	>  int $0x80
 161              	
 162              	.end
GAS LISTING task5.S 			page 9


GAS LISTING task5.S 			page 10


DEFINED SYMBOLS
             task5.S:9      .bss:0000000000000000 buf_vector
             task5.S:9      .bss:000000000000000a c
             task5.S:14     .data:0000000000000000 ten
             task5.S:15     .data:0000000000000004 l
             task5.S:16     .data:0000000000000008 k
             task5.S:17     .data:000000000000000c f
             task5.S:18     .data:0000000000000010 i
             task5.S:19     .data:0000000000000014 sum
             task5.S:20     .data:0000000000000018 Matrix
             task5.S:27     .data:00000000000000a8 vector
             task5.S:33     .text:0000000000000000 _start
             task5.S:34     .data:00000000000000c0 str0
             task5.S:34     *ABS*:000000000000002a strlen0
             task5.S:36     .text:0000000000000016 kdb_input_k
             task5.S:158    .text:000000000000022e end
             task5.S:51     .text:0000000000000067 changer
             task5.S:139    .text:00000000000001c0 print_err_msg1
             task5.S:147    .text:00000000000001f6 error_inpit_k
             task5.S:57     .data:00000000000000ea str2
             task5.S:57     *ABS*:000000000000002a strlen2
             task5.S:59     .text:0000000000000097 kdb_input_l
             task5.S:75     .text:00000000000000e9 next
             task5.S:143    .text:00000000000001db print_err_msg
             task5.S:151    .text:0000000000000211 error_inpit_l
             task5.S:84     .text:0000000000000107 pod_k
             task5.S:96     .text:0000000000000124 pod_l
             task5.S:114    .text:0000000000000165 del1
             task5.S:129    .data:0000000000000114 str4
             task5.S:129    *ABS*:0000000000000002 strlen4
             task5.S:140    .data:0000000000000116 str5
             task5.S:140    *ABS*:0000000000000022 strlen5
             task5.S:144    .data:0000000000000138 str6
             task5.S:144    *ABS*:0000000000000022 strlen6
             task5.S:148    .data:000000000000015a str7
             task5.S:148    *ABS*:0000000000000011 strlen7
             task5.S:152    .data:000000000000016b str8
             task5.S:152    *ABS*:0000000000000011 strlen8
             task5.S:155    .text:000000000000022c text

NO UNDEFINED SYMBOLS
